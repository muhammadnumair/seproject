@using uetquizing.Models
@model QuizQuestions

@{
    ViewBag.Title = "Quiz";
    Layout = "~/Views/Shared/_Layout_Backend.cshtml";
    ViewBag.Role = "Student";
}

<div class="main-content" style="margin-top: 10px;">
    <!-- CONTENT -->
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 col-xl-8">

                <!-- Card -->
                <div class="card">
                    <div class="card-body">

                        <!-- Header -->
                        <div class="mb-3">
                            <div class="row align-items-center">
                                <div class="col-auto">

                                    <!-- Avatar -->
                                    <a href="#!" class="avatar">
                                        <img src="~/assets/img/avatars/profiles/avatar-1.jpg" alt="..." class="avatar-img rounded-circle">
                                    </a>

                                </div>
                                <div class="col ml--2">

                                    <!-- Title -->
                                    <h4 class="card-title mb-1">
                                        Dianna Smiley
                                    </h4>

                                    <!-- Time -->
                                    <p class="card-text small text-muted">
                                        <span class="fe fe-clock"></span> <time datetime="2018-05-24">4hr ago</time>
                                    </p>

                                </div>
                            </div> <!-- / .row -->
                        </div>
                        @if (ViewBag.status == 1)
                        {
                            using (Html.BeginForm("SubmitQuiz", "User", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-horizontal", role = "form", id="myForm" }))
                            {
                                <div class="card-body">
                                    <input type="hidden" name="quizID" value="@ViewBag.QuizID" />
                                    <input type="hidden" name="variations_id" value="@ViewBag.VariationID" />
                                    <ul class="list-group list-group-lg list-group-flush list my--4">
                                        @{
                                            if (ViewBag.questions.Count > 0)
                                            {
                                                var count = 1;
                                                foreach (var question in ViewBag.questions)
                                                {
                                                    <li class="list-group-item px-0">

                                                        <div class="row align-items-center">
                                                            <div class="col-12">

                                                                <!-- Question Title -->
                                                                <h4 class="card-title mb-1 name">
                                                                    <a href="#!">@(count + ". " + question.question_title)</a>
                                                                </h4>
                                                                <input type="hidden" name="Questions[@(count - 1)].questionID" value="@question.question_id" />
                                                                <!-- Question Options -->
                                                                <div style="margin: 20px 20px 0px 20px;">
                                                                    <input type="radio" name="Questions[@(count - 1)].selectedOption" value="@question.option_1"> @question.option_1<br>
                                                                    <input type="radio" name="Questions[@(count - 1)].selectedOption" value="@question.option_2"> @question.option_2<br>
                                                                    <input type="radio" name="Questions[@(count - 1)].selectedOption" value="@question.option_3"> @question.option_3<br>
                                                                    <input type="radio" name="Questions[@(count - 1)].selectedOption" value="@question.option_4"> @question.option_4<br>
                                                                </div>
                                                            </div>
                                                        </div> <!-- / .row -->
                                                    </li>
                                                    count++;
                                                }
                                            }
                                        }
                                    </ul>
                                </div>
                            <!-- Buttons -->
                                            <div class="mb-3">
                                                <div class="row">
                                                    <div class="col">

                                                        <a href="#!" class="btn btn-sm btn-white">
                                                            😬 1
                                                        </a>
                                                        <a href="#!" class="btn btn-sm btn-white">
                                                            👍 2
                                                        </a>
                                                        <a href="#!" class="btn btn-sm btn-white">
                                                            Add Reaction
                                                        </a>

                                                    </div>
                                                </div> <!-- / .row -->
                                            </div>

                            <!-- Divider -->
                                            <hr>

                            <!-- Comments -->

                                            <button type="submit" class="btn btn-block btn-primary">Submit Quiz</button>

                                                }
                                            }
                                            else
                                            {
                                                <hr />
                                                <div class="alert alert-dark" role="alert">
                                                    Your Teacher Has Not Started The Quiz Yet, Please Check Back Later
                                                </div>
                                            }

                        </div>
                </div>
            </div>
            <div class="col-12 col-xl-4">

                <!-- Card -->
                <div class="card">
                    <div class="card-body">

                        <div class="row align-items-center">
                            <div class="col">

                                <!-- Title -->
                                <h5 class="mb-0">
                                    Birthday
                                </h5>

                            </div>
                            <div class="col-auto">

                                <time class="small text-muted" datetime="1988-10-24" @if (ViewBag.status != 1) { <text> style="filter: blur(3px)"</text>}>
                                    10/24/88
                                </time>

                            </div>
                        </div> <!-- / .row -->
                        <!-- Divider -->
                        <hr>

                        <div class="row align-items-center">
                            <div class="col">

                                <!-- Title -->
                                <h5 class="mb-0">
                                    Joined
                                </h5>

                            </div>
                            <div class="col-auto">

                                <time class="small text-muted" datetime="2018-10-28" @if (ViewBag.status != 1) { <text> style="filter: blur(3px)"</text>}>
                                    10/24/18
                                </time>

                            </div>
                        </div> <!-- / .row -->
                        <!-- Divider -->
                        <hr>

                        <div class="row align-items-center">
                            <div class="col">

                                <!-- Title -->
                                <h5 class="mb-0">
                                    Location
                                </h5>

                            </div>
                            <div class="col-auto">

                                <small class="text-muted" @if (ViewBag.status != 1) { <text> style="filter: blur(3px)"</text>}>
                                    Los Angeles, CA
                                </small>

                            </div>
                        </div> <!-- / .row -->
                        <!-- Divider -->
                        <hr>

                        <div class="row align-items-center">
                            <div class="col">

                                <!-- Title -->
                                <h5 class="mb-0">
                                    Website
                                </h5>

                            </div>
                            <div class="col-auto">

                                <a href="#!" class="small" @if (ViewBag.status != 1) { <text> style="filter: blur(3px)"</text>}>
                                    themes.getbootstrap.com
                                </a>

                            </div>
                        </div> <!-- / .row -->

                    </div>
                </div>
            </div>
        </div> <!-- / .row -->
    </div>
</div>

@if (ViewBag.status == 1)
{
    @section Scripts {
        <script>
            $(document).ready(function () {
                sendRequest();
                function sendRequest() {
                    $.ajax({
                        url: "/User/check_status/"+@ViewBag.quiz_id,
                        success:
                          function (data) {
                              if(data == 1){
                                  setInterval(sendRequest, 10000);
                              }

                              if(data == 0){ //Quiz Band Ho Gyaa Hai
                                  document.getElementById("myForm").submit();
                              }
                          }
                    });
                };
            });
        </script>
    }
}